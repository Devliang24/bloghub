# Pytest æ•™ç¨‹ - 01. ç®€ä»‹ä¸å®‰è£…

> **é€‚åˆäººç¾¤**ï¼šPython å¼€å‘è€…
> **å‰ç½®çŸ¥è¯†**ï¼šPython åŸºç¡€
> **é¢„è®¡æ—¶é—´**ï¼š15 åˆ†é’Ÿ

## ğŸ§ª ä¸ºä»€ä¹ˆé€‰æ‹© Pytestï¼Ÿ

**Pytest** æ˜¯ Python ç”Ÿæ€ä¸­æœ€æµè¡Œã€æœ€å¼ºå¤§çš„æµ‹è¯•æ¡†æ¶ã€‚
*   **ç®€å•**ï¼šæ— éœ€æ ·æ¿ä»£ç ï¼Œç›´æ¥å†™å‡½æ•°å³å¯æµ‹è¯•ã€‚
*   **å¼ºå¤§**ï¼šä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ï¼ˆ`pytest-django`, `pytest-asyncio` ç­‰ï¼‰ã€‚
*   **æ™ºèƒ½**ï¼šè¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šï¼Œæ— éœ€å¤æ‚çš„ `assertEqual`ã€‚

### è¿è¡Œæœºåˆ¶

```mermaid
graph LR
    Start[å‘½ä»¤: pytest] --> Collect[æ”¶é›†é˜¶æ®µ<br>Collection]
    Collect --> Filter[è¿‡æ»¤é˜¶æ®µ<br>Filtering]
    Filter --> Run[æ‰§è¡Œé˜¶æ®µ<br>Execution]
    Run --> Report[æŠ¥å‘Šé˜¶æ®µ<br>Reporting]
    
    Collect -.->|å¯»æ‰¾ test_*.py| Files[æµ‹è¯•æ–‡ä»¶]
    Run -->|æ‰§è¡Œ setup| Fixture[Fixture]
    Run -->|æ‰§è¡Œ assert| TestFunc[æµ‹è¯•å‡½æ•°]
```

## ğŸ› ï¸ å®‰è£… Pytest

æˆ‘ä»¬æ¨èä½¿ç”¨ **UV** è¿›è¡Œå®‰è£…ï¼Œé€Ÿåº¦æå¿«ã€‚

```bash
# æ·»åŠ ä¸ºå¼€å‘ä¾èµ–
uv add --dev pytest
```

æˆ–è€…ä½¿ç”¨ pipï¼ˆé…åˆæ¸…åæºï¼‰ï¼š

```bash
pip install pytest -i https://pypi.tuna.tsinghua.edu.cn/simple
```

éªŒè¯å®‰è£…ï¼š

```bash
pytest --version
```

## ğŸš€ ç¼–å†™ç¬¬ä¸€ä¸ªæµ‹è¯•

åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ `test_sample.py`ï¼š

```python
def func(x):
    return x + 1

def test_answer():
    assert func(3) == 5
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
pytest
```

ä½ å°†çœ‹åˆ°çº¢è‰²çš„ `FAILED` æç¤ºï¼Œè¿™æ­£æ˜¯ Pytest çš„å¼ºå¤§ä¹‹å¤„â€”â€”å®ƒä¼šå‘Šè¯‰ä½ å…·ä½“çš„å¤±è´¥åŸå› ï¼š

```
E       assert 4 == 5
E        +  where 4 = func(3)
```

## ğŸ“š æ€»ç»“

*   Pytest æ˜¯å¼€ç®±å³ç”¨çš„æµ‹è¯•æ¡†æ¶ã€‚
*   æµ‹è¯•æ–‡ä»¶é€šå¸¸ä»¥ `test_` å¼€å¤´ã€‚
*   ä½¿ç”¨ç®€å•çš„ `assert` è¯­å¥å³å¯è¿›è¡Œæ–­è¨€ã€‚

ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†æ·±å…¥äº†è§£ **æ–­è¨€ä¸æŠ¥å‘Š**ã€‚
